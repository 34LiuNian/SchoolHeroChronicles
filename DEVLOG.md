# 开发笔记

## 2025-10-06 - 基础架构完成

### 完成内容

#### 1. 核心系统搭建

- ✅ 变量系统（学科、压力、好感度、周次追踪）
- ✅ 角色定义系统
- ✅ HUD状态显示
- ✅ 调试工具面板
- ✅ 音频系统封装

#### 2. 李慕云线路剧情

- ✅ Week 1: 雨天是城市的祭日（完整）
- ✅ Week 2: 拳皇（完整+关键选择）
- ✅ Week 3: 家访（条件触发+分支）
- ✅ Week 4: 好/坏结局（两个完整结局）

#### 3. 文档体系

- ✅ README.md - 快速启动指南
- ✅ ARCHITECTURE.md - 架构说明
- ✅ IMAGE_ASSETS_PLAN.md - 图片资源规划
- ✅ 音频系统注释文档

### 关键设计决策

#### 分支逻辑

采用"关键选择点"设计：

- Week 2的邀请选择是第一个分水岭
- Week 3的帮助选择是第二个分水岭
- 两个选择都正确才能达成好结局

**理由：** 强调"参与"和"行动"的重要性，而非单纯好感度累积。

#### 变量分离

虽然定义了学科/压力系统，但李慕云线不依赖这些：

- 保留系统为未来其他线路预留
- 每条线路可以有自己的核心机制
- 避免系统过于复杂

#### HUD设计

右上角轻量级显示：

- 不遮挡对话和立绘
- 实时反馈玩家选择结果
- 压力值分级颜色提示（绿/黄/红）

### 技术亮点

1. **模块化架构**
   - 每条线路独立 .rpy 文件
   - 系统功能分离（变量/音频/UI）
   - 便于多人协作开发

2. **调试友好**
   - Shift+D 快捷调试面板
   - 实时HUD反馈
   - 日志记录系统

3. **可扩展性**
   - 角色好感度字典结构
   - 音频系统统一封装
   - 周次结构可无限扩展

### 待完善功能

#### 高优先级

1. **图片资源**
   - [ ] 教室背景（Week 1-4 通用）
   - [ ] 李慕云基础表情立绘（happy/sad/worried）
   - [ ] 食堂、电玩城、公寓背景

2. **音频资源**
   - [ ] 日常场景BGM
   - [ ] 紧张场景BGM
   - [ ] 结局BGM（好/坏）
   - [ ] 雨声环境音

3. **体验优化**
   - [ ] 存档缩略图
   - [ ] 选择项悬停效果
   - [ ] 文本显示速度调节

#### 中优先级

1. **剧情扩充**
   - [ ] Week 1-3 增加更多日常对话
   - [ ] 添加更多好感度获得点
   - [ ] 丰富结局后日谈

2. **系统完善**
   - [ ] 成就系统框架
   - [ ] 回想模式（CG/音乐鉴赏）
   - [ ] 多结局解锁追踪

3. **UI美化**
   - [ ] 自定义对话框样式
   - [ ] 选择菜单美化
   - [ ] 加载界面设计

#### 低优先级

1. **额外内容**
   - [ ] 其他角色线路
   - [ ] 支线剧情
   - [ ] 隐藏结局

2. **多语言支持**
   - [ ] 英文翻译
   - [ ] 繁体中文

### 已知问题

1. ~~Markdown文档有格式警告~~ - 不影响功能
2. 目前使用默认占位图片 - 等待美术资源
3. 音频文件路径已定义但文件缺失 - 等待音频资源

### 测试清单

#### 功能测试

- [x] 从头开始完整通关
- [x] 好结局达成条件
- [x] 坏结局路线1（拒绝邀请）
- [x] 坏结局路线2（接受但不帮助）
- [x] HUD数值正确更新
- [x] 调试面板功能正常

#### 兼容性测试

- [ ] Windows运行测试
- [ ] Mac运行测试
- [ ] Linux运行测试
- [ ] 不同分辨率适配

#### 边界测试

- [ ] 存档/读档兼容性
- [ ] 快进/快退功能
- [ ] 跳过已读文本
- [ ] 历史记录回溯

### 性能优化

当前版本性能表现良好，暂无优化需求。
待添加大量图片/音频资源后，需要考虑：

- 资源懒加载
- 图片压缩优化
- 音频流式播放

### 代码规范

#### 已遵循

- ✅ 4空格缩进
- ✅ 变量命名统一（snake_case）
- ✅ 常量大写（UPPER_CASE）
- ✅ 函数文档字符串

#### 待统一

- [ ] Label命名约定（目前是 weekX_character）
- [ ] 注释语言（中英混用）

### 下一步行动计划

**本周目标：**

1. 寻找/委托美术资源
2. 收集/购买BGM素材
3. 完成一个完整可展示版本

**下周目标：**

1. 完善Week 1-3对话细节
2. 添加更多选择分支
3. 开始第二条角色线路设计

**月度目标：**

1. 完成至少2条完整角色线路
2. 实现成就系统
3. 添加回想模式
4. 进行第一次公开测试

### 开发感想

李慕云线的核心主题是"关注与行动"。不仅要关心他人的处境，更要在关键时刻采取行动。这个设计理念贯穿整个剧情分支。

好结局并不是"完美"结局，只是"希望尚存"。坏结局则是"无法挽回的遗憾"。两个结局都有其情感重量，不是简单的对错二分。

### 技术债务

目前无技术债务。架构清晰，代码规范。

### 参考资源

- Ren'Py官方文档: <https://www.renpy.org/doc/html/>
- 视觉小说最佳实践: <https://vndev.wiki/>
- 游戏写作指南: <https://www.gamasutra.com/view/feature/134542/>

---

*记录人：AI Copilot*
*日期：2025-10-06*
